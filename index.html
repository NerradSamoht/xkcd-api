<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>xkcd comic</title>
  <meta name="description" content="Displays the current or random xkcd.">
  <meta name="viewport" content="width=device-width,initial-scale=1">
	<style>
		@-ms-viewport { width: device-width; }
		@-o-viewport  { width: device-width; }
		@viewport     { width: device-width; }
		* { box-sizing: border-box; }
		body { 
			text-align: center; 
			font-family: "Comic Sans MS", cursive, sans-serif;
		}
		img { 
			max-width: 100%; 
		}
		button {
			border: 2px solid black;
			padding: 1rem;
			margin: 1rem;
			background-color: #fff;
			font-size: 1.1rem;
		}
		@media (min-width: 60rem) {
			button {
				width: 100%;
				max-width: 160px;
			}	
		}
		button:hover {
			background-color: #ddd;
			cursor: pointer;
		}
		p {
	    	font-size: 0.9em;
	    	padding: 6px;
			width: 100%;
	    	max-width: 640px;
    		margin: 1rem auto;
		}
	</style>
</head>
<body>
	<div id='buttons'>
		<button id='current'>Current</button>
		<button id='random'>Random</button>
	</div>
	<div id='xkcd'></div>
	<div id='description'></div>
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
	<script>
		$(function() {
			var max = 0;
			getxkcd();

			$('#random').click(function() {
				var num = Math.floor(Math.random() * max) + 1;
				getxkcd(num);
			});

			$('#current').click(function() {
				getxkcd();
			});

			function getxkcd(num) {
				var url;
				if (num) {
					url = 'https://dynamic.xkcd.com/api-0/jsonp/comic/' + num;
				} else {
					url = 'https://dynamic.xkcd.com/api-0/jsonp/comic?callback=?';
				}
				$.ajax({
					url: url,
					data: {
						format: 'jsonp'
					},
					error: function() {
						$('#xkcd').html("<p>Ruh roh! Something's not working.</p>");
					},
					dataType: 'jsonp',
					success: function(data) {
						max = data.num > max ? data.num : max;
						var $title = '<h1>' + data.title;
						var $image = $('<img>').attr({ src: data.img, alt: data.title });
						var $description = '<p>' + data.alt;
						$('#xkcd').html($title).append($image);
						$('#description').append($description);
					}
				});
			};
		});
	</script>
</body>
</html>
